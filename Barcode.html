<html>
    <head>

    </head>
    <body onLoad='setBarcodeField()'>

        <h1>Reader Demo</h1>
        <h2>v1.14</h2>
        <!-- <a href="market://details?id=com.myapp.package">Click me to market</a>
        <a href="exampleapps://details?id=com.myapp.package">Click me to myApp</a> -->
        <label for="barcodeValue">Barcode Value:</label>
        <input type="text" id="barcodeValue" name="bvalue"><br><br>
        
        <label for="barcodeType">Barcode Type:</label>
        <input type="text" id="barcodeType" name="btype"><br><br>
        
        <button onclick="window.location.href='reader://barcode?redirecturl=https://testinggrabba.github.io/Barcode.html'">
            >>> Press me to get Barcode! <<<
          </button>

    </body>

    <script type='text/javascript'>

        function setBarcodeField()  {
            var qString = location.search;
            var keyValues = getAllParameters(qString);

            var barcodeValue = "barcodeValue";
            var barcodeType = "barcodeType";

            // Console
            console.log(keyValues);

            // Extract -- Barcode
            if (qString.indexOf(barcodeValue) != -1) {
                var barval = keyValues[barcodeValue];
                document.getElementById("barcodeValue").value = barval.toString();
            }

            // Extract -- BarcodeType
            if (qString.indexOf(barcodeType) != -1) {
                var bartype = keyValues[barcodeType];
                document.getElementById("barcodeType").value = bartype.toString();
            }
        }

        function getAllParameters(qString) {
            var sections = qString.split("&");
            var dict = {};
            
            for (i = 0; i < sections.length ; i++) {
                var cSection = sections[i];
                var param = cSection.split("=");

                // Trim strings
                if (param[0].substring(0,1) == "?") {
                    dict[param[0].substring(1, param[0].length)] = param[1];
                } else {
                    dict[param[0]] = param[1];
                }
            }

            return dict;
        }
    </script>

</html>